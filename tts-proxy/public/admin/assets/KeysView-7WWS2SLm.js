import{d as j,j as z,k as p,c as G,o as B,f as r,b as l,e,t as i,F as E,g as N,n as K,l as A,u as v,m as F,a as D,w as O,p as M,v as R,q as Y}from"./index-QCUBHikX.js";import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BitsU6QT.js";import{u as P}from"./keys-nZhi-fMI.js";import{E as J}from"./index-BVP15cf-.js";const Q={class:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-hidden"},W={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},X={class:"text-lg font-semibold text-gray-900"},Z={class:"text-sm text-gray-500 mt-1"},I={class:"p-6 overflow-y-auto max-h-[60vh]"},ee={key:0,class:"text-center py-8 text-gray-500"},te={key:1,class:"space-y-3"},se={class:"flex items-center justify-between p-4"},oe={class:"flex items-center gap-3 flex-1"},ne={class:"relative inline-flex items-center cursor-pointer"},ae=["checked","onChange"],le={class:"font-medium text-gray-900"},re={class:"text-sm text-gray-500"},ie={class:"flex items-center gap-2"},de=["onClick"],ue={key:0,class:"px-4 pb-4 border-t border-gray-100 bg-gray-50"},ce={class:"pt-4 space-y-4"},pe={class:"flex items-center gap-3"},xe={class:"flex bg-gray-200 rounded-lg p-1"},ye=["onClick"],ge=["onClick"],me={key:0,class:"space-y-3"},fe={class:"block text-sm font-medium text-gray-700 mb-1"},be=["value","onInput","placeholder"],ve={key:1,class:"text-sm text-gray-500 italic"},he={class:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3"},_e=["disabled"],Ce=j({__name:"EngineConfigModal",props:{keyId:{},keyName:{},isAdminKey:{type:Boolean}},emits:["close"],setup(S,{emit:c}){const g=S,x=c,m=P(),h=z(),f=p({}),k=p(!0),_=p(!1),C=p(null),w=G(()=>h.isAdmin);B(async()=>{const n=await m.getEngineConfig(g.keyId);n&&(f.value=n),k.value=!1});function b(n){return f.value[n]||(f.value[n]={enabled:!0}),f.value[n]}function d(n){return b(n).enabled??!0}function t(n){const o=b(n);o.enabled=!o.enabled}function s(n){return b(n).useCustomCredentials??!1}function $(n){const o=b(n);o.useCustomCredentials=!o.useCustomCredentials,o.useCustomCredentials&&!o.credentials&&(o.credentials={})}function T(n,o){return b(n).credentials?.[o]??""}function U(n,o,u){const a=b(n);a.credentials||(a.credentials={}),a.credentials[o]=u}function V(n){C.value=C.value===n?null:n}async function q(){_.value=!0;const n=await m.updateEngineConfig(g.keyId,f.value);_.value=!1,n&&x("close")}return(n,o)=>(l(),r("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o[2]||(o[2]=F(u=>x("close"),["self"]))},[e("div",Q,[e("div",W,[e("div",null,[e("h3",X," Configure Engines: "+i(S.keyName),1),e("p",Z,i(w.value?"Enable engines and optionally set custom credentials":"Enable or disable available engines"),1)]),e("button",{onClick:o[0]||(o[0]=u=>x("close")),class:"text-gray-400 hover:text-gray-600 text-2xl"}," âœ• ")]),e("div",I,[k.value?(l(),r("div",ee," Loading configuration... ")):(l(),r("div",te,[(l(!0),r(E,null,N(v(J),(u,a)=>(l(),r("div",{key:a,class:K(["border rounded-lg overflow-hidden",d(a)?"border-gray-200":"border-gray-100 bg-gray-50"])},[e("div",se,[e("div",oe,[e("label",ne,[e("input",{type:"checkbox",checked:d(a),onChange:y=>t(a),class:"sr-only peer"},null,40,ae),o[3]||(o[3]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))]),e("div",null,[e("div",le,i(u.name),1),e("div",re,i(u.description),1)])]),e("div",ie,[e("span",{class:K([u.type==="free"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800","text-xs px-2 py-0.5 rounded"])},i(u.type),3),u.requiresKey&&w.value&&d(a)?(l(),r("button",{key:0,onClick:y=>V(a),class:"px-2 py-1 text-sm text-gray-500 hover:text-gray-700"},i(C.value===a?"â–²":"â–¼"),9,de)):A("",!0)])]),u.requiresKey&&w.value&&d(a)&&C.value===a?(l(),r("div",ue,[e("div",ce,[e("div",pe,[o[4]||(o[4]=e("span",{class:"text-sm text-gray-600"},"Credentials:",-1)),e("div",xe,[e("button",{onClick:y=>s(a)&&$(a),class:K([s(a)?"text-gray-500":"bg-white shadow text-gray-900","px-3 py-1 text-sm rounded-md transition-all"])}," Use System Default ",10,ye),e("button",{onClick:y=>!s(a)&&$(a),class:K([s(a)?"bg-white shadow text-gray-900":"text-gray-500","px-3 py-1 text-sm rounded-md transition-all"])}," Custom Credentials ",10,ge)])]),s(a)?(l(),r("div",me,[(l(!0),r(E,null,N(u.keyFields,y=>(l(),r("div",{key:y},[e("label",fe,i(y),1),e("input",{type:"password",value:T(a,y),onInput:L=>U(a,y,L.target.value),placeholder:y.includes("KEY")?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter value",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,be)]))),128)),o[5]||(o[5]=e("p",{class:"text-xs text-gray-500"}," ðŸ’¡ Custom credentials will be used instead of system defaults for this API key. ",-1))])):(l(),r("div",ve," Using system-wide credentials configured by administrator. "))])])):A("",!0)],2))),128))]))]),e("div",he,[e("button",{onClick:o[1]||(o[1]=u=>x("close")),class:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{onClick:q,disabled:_.value,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50"},i(_.value?"Saving...":"Save Changes"),9,_e)])])]))}}),ke={class:"space-y-6"},we={class:"flex justify-between items-center"},$e={key:0,class:"bg-white rounded-lg shadow p-6"},Ke={class:"flex items-center gap-2"},Ae={key:1,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Se={class:"flex items-center gap-2 bg-white p-3 rounded border font-mono text-sm"},Ee={class:"flex-1 break-all"},Ne={class:"bg-white rounded-lg shadow overflow-hidden"},De={class:"w-full"},Me={class:"divide-y divide-gray-200"},je={class:"px-6 py-4 font-medium text-gray-900"},Be={class:"px-6 py-4"},Fe={key:0,class:"font-mono text-sm text-gray-500"},Pe={key:1,class:"text-gray-400 text-sm"},Te={class:"px-6 py-4"},Ue={key:0,class:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded"},Ve={key:1,class:"text-gray-500 text-sm"},qe={class:"px-6 py-4"},Le={class:"px-6 py-4 text-sm text-gray-500"},ze={class:"px-6 py-4"},Ge={class:"flex gap-2"},Oe=["onClick"],Re=["onClick"],Ye=["onClick"],Xe=j({__name:"KeysView",setup(S){const c=P(),g=p(""),x=p(!1),m=p(!1),h=p(null),f=p(""),k=p(!1);async function _(){g.value.trim()&&(await c.createKey({name:g.value.trim(),isAdmin:x.value}),g.value="",x.value=!1,m.value=!1)}async function C(d){await navigator.clipboard.writeText(d)}function w(d,t,s){h.value=d,f.value=t,k.value=s}function b(d){return d?new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Never"}return B(()=>c.fetchKeys()),(d,t)=>(l(),D(H,null,{default:O(()=>[e("div",ke,[e("div",we,[t[5]||(t[5]=e("h2",{class:"text-2xl font-bold text-gray-900"},"API Keys",-1)),e("button",{onClick:t[0]||(t[0]=s=>m.value=!m.value),class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},i(m.value?"Cancel":"Create Key"),1)]),m.value?(l(),r("div",$e,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold mb-4"},"Create New API Key",-1)),e("form",{onSubmit:F(_,["prevent"]),class:"space-y-4"},[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Key Name",-1)),M(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Production App"},null,512),[[R,g.value]])]),e("div",Ke,[M(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>x.value=s),type:"checkbox",id:"isAdmin",class:"rounded"},null,512),[[Y,x.value]]),t[7]||(t[7]=e("label",{for:"isAdmin",class:"text-sm text-gray-700"},"Admin privileges",-1))]),t[8]||(t[8]=e("button",{type:"submit",class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg"}," Create ",-1))],32)])):A("",!0),v(c).lastCreatedKey?(l(),r("div",Ae,[t[10]||(t[10]=e("p",{class:"text-green-800 font-medium mb-2"},"âœ… API Key Created Successfully!",-1)),e("div",Se,[e("span",Ee,i(v(c).lastCreatedKey),1),e("button",{onClick:t[3]||(t[3]=s=>C(v(c).lastCreatedKey)),class:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded"}," Copy ")]),t[11]||(t[11]=e("p",{class:"text-sm text-green-700 mt-2"},"âš ï¸ Save this key now - it won't be shown again!",-1))])):A("",!0),e("div",Ne,[e("table",De,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Key"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Created"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",Me,[(l(!0),r(E,null,N(v(c).keys,s=>(l(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",je,i(s.name),1),e("td",Be,[s.keySuffix?(l(),r("span",Fe," tts_â€¢â€¢â€¢â€¢..."+i(s.keySuffix),1)):(l(),r("span",Pe,"N/A"))]),e("td",Te,[s.isAdmin?(l(),r("span",Ue,"Admin")):(l(),r("span",Ve,"Regular"))]),e("td",qe,[e("span",{class:K([s.active?"text-green-600":"text-red-600","font-medium"])},i(s.active?"Active":"Inactive"),3)]),e("td",Le,i(b(s.createdAt)),1),e("td",ze,[e("div",Ge,[e("button",{onClick:$=>w(s.id,s.name,s.isAdmin),class:"px-2 py-1 text-sm border rounded hover:bg-gray-50"},"âš™ï¸",8,Oe),e("button",{onClick:$=>v(c).toggleKeyStatus(s.id,!s.active),class:"px-2 py-1 text-sm border rounded hover:bg-gray-50"},i(s.active?"Disable":"Enable"),9,Re),e("button",{onClick:$=>v(c).deleteKey(s.id),class:"px-2 py-1 text-sm text-red-600 border border-red-200 rounded hover:bg-red-50"},"Delete",8,Ye)])])]))),128))])])])]),h.value?(l(),D(Ce,{key:0,"key-id":h.value,"key-name":f.value,"is-admin-key":k.value,onClose:t[4]||(t[4]=s=>h.value=null)},null,8,["key-id","key-name","is-admin-key"])):A("",!0)]),_:1}))}});export{Xe as default};
